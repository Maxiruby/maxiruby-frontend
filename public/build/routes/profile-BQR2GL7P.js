import{a as C,b as L}from"/build/_shared/chunk-KO6BBNLA.js";import{a as m}from"/build/_shared/chunk-VKMHKPOH.js";import{a as w}from"/build/_shared/chunk-247SV4KM.js";import"/build/_shared/chunk-OKFWYDNW.js";import{b as S,d as b}from"/build/_shared/chunk-2QQBSPFY.js";import{a as R,b as P}from"/build/_shared/chunk-Q6JY3F4H.js";import{f as g}from"/build/_shared/chunk-ZSCMMWXX.js";var l=g(R());var e=g(P()),k=()=>[{title:"Profile \u2014 Maxiruby"},{name:"description",content:"Profile \u2014 Maxiruby"}];function I(){let t=S(),n=JSON.parse(localStorage?.getItem("profile")),[h,O]=(0,l.useState)(n?.username),[v,T]=(0,l.useState)(n?.surname),[y,o]=(0,l.useState)(""),[F,r]=(0,l.useState)(""),[f,s]=(0,l.useState)(!1),[u,j]=(0,l.useState)(""),B=async()=>{s(!0);try{var a=new Headers;a.append("Content-Type","application/json");var d=JSON.stringify({username:h,surname:v});a.append("Authorization","Bearer "+localStorage.getItem("token")?.replace(/['"]+/g,""));var x={method:"POST",headers:a,body:d,redirect:"follow"};let N=await(await fetch("https://api.maxiruby.com/api/users/auth/update",x)).json();s(!1),localStorage.setItem("profile",JSON.stringify(N.result.user)),o("Profile updated successfully"),setTimeout(()=>{o("")},2e3),r("")}catch(i){r(i.message),s(!1),o("")}},G=async()=>{if(o(""),r(""),s(!0),!u){r("Password is required"),setTimeout(()=>{r(""),s(!1)},2e3);return}try{var a=new Headers;a.append("Content-Type","application/json");var d=JSON.stringify({newpassword:u});a.append("Authorization","Bearer "+localStorage.getItem("token")?.replace(/['"]+/g,""));var x={method:"POST",headers:a,body:d,redirect:"follow"};let N=await(await fetch("https://api.maxiruby.com/api/users/auth/resetpassword",x)).json();o("Profile updated successfully"),setTimeout(()=>{o(""),localStorage.removeItem("profile"),localStorage.removeItem("token"),t("/login")},2e3),r("")}catch(i){s(!1),r(i.message),o("")}};return(0,e.jsx)("div",{className:"flex flex-1 flex-col h-full min-h-[75vh]",children:(0,e.jsx)(L,{children:(0,e.jsx)(C,{children:(0,e.jsxs)("div",{className:"flex flex-1 flex-col gap-y-12",children:[(0,e.jsx)("header",{className:"flex flex-1 flex-col items-center justify-center",children:(0,e.jsx)("h1",{className:"text-3xl font-medium font-heading",children:"Profile Settings"})}),(0,e.jsx)("main",{className:"flex flex-1 flex-col items-center justify-center",children:(0,e.jsx)(b,{className:"flex flex-1 w-full max-w-[720px] mx-auto",children:(0,e.jsxs)(D,{children:[(0,e.jsxs)(J,{children:[(0,e.jsxs)(c,{children:[(0,e.jsx)(p,{optional:!0,children:"Username"}),(0,e.jsx)(m,{type:"text",value:h,placeholder:"Name",onChange:a=>{O(a.target.value)},className:"w-full min-w-[160px]"})]}),(0,e.jsxs)(c,{children:[(0,e.jsx)(p,{optional:!0,children:"Surname"}),(0,e.jsx)(m,{type:"text",value:v,placeholder:"Surname",onChange:a=>{T(a.target.value)},className:"w-full min-w-[200px]"})]})]}),(0,e.jsxs)(c,{children:[(0,e.jsx)(p,{children:"Email Adress"}),(0,e.jsx)(m,{type:"text",value:"",placeholder:n?.email,onChange:()=>{},className:"w-full min-w-[200px]"})]}),(0,e.jsxs)(c,{children:[(0,e.jsx)(p,{children:"Password"}),(0,e.jsxs)("div",{className:"flex flex-1 items-stretch flex-wrap gap-4",children:[(0,e.jsx)(m,{type:"password",value:u,placeholder:"********",onChange:a=>{j(a.target.value)},className:"flex flex-[5] min-w-[200px]"}),(0,e.jsx)(w,{type:"button",title:"Reset Password",variant:"border",className:"flex-[1] min-w-[200px]",onClick:G,disabled:f,children:f?"Loading...":"Reset Password"})]})]}),y?(0,e.jsxs)("small",{style:{color:"green"},children:[" ",y]}):null,F?(0,e.jsxs)("small",{style:{color:"red"},children:[" ",F]}):null,(0,e.jsx)(c,{children:(0,e.jsx)(w,{onClick:B,disabled:f,type:"button",title:"Save Changes",variant:"primary",className:"w-fit mx-auto px-8",children:f?"Loading...":"Save Changes"})})]})})})]})})})})}function D({children:t}){return(0,e.jsx)("div",{className:"flex flex-1 flex-col justify-center items-center gap-y-6",children:t})}function c({children:t}){return(0,e.jsx)("div",{className:"flex flex-1 flex-col gap-y-2 w-full",children:t})}function J({children:t}){return(0,e.jsx)("div",{className:"flex flex-1 flex-row flex-wrap gap-4 w-full",children:t})}function p({children:t,optional:n=!1}){return(0,e.jsxs)("label",{className:"flex flex-1 flex-row items-center gap-x-1",children:[(0,e.jsx)("span",{className:"text-sm font-semibold text-foreground",children:t}),n&&(0,e.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:"(Optional)"})]})}export{I as default,k as meta};
